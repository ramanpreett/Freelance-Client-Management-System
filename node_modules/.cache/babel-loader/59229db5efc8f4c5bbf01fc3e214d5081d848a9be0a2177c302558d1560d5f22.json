{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import axios from\"axios\";import InvoiceForm from\"./InvoiceForm\";import InvoiceList from\"./InvoiceList\";import{generateInvoicePDF}from\"../utils/pdfExport\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_URL=process.env.REACT_APP_API_URL+\"/api/invoices\";const CLIENTS_URL=process.env.REACT_APP_API_URL+\"/api/clients\";const Invoices=()=>{const[invoices,setInvoices]=useState([]);const[clients,setClients]=useState([]);const[error,setError]=useState(\"\");const fetchInvoices=async()=>{try{const res=await axios.get(API_URL,{headers:{Authorization:localStorage.getItem(\"token\")}});setInvoices(res.data);setError(\"\");}catch(err){var _err$response,_err$response$data;setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.error)||err.message);}};const fetchClients=async()=>{try{const res=await axios.get(CLIENTS_URL,{headers:{Authorization:localStorage.getItem(\"token\")}});setClients(res.data);}catch(_unused){}};useEffect(()=>{fetchInvoices();fetchClients();},[]);const addInvoice=async invoice=>{try{await axios.post(API_URL,invoice,{headers:{Authorization:localStorage.getItem(\"token\")}});fetchInvoices();setError(\"\");}catch(err){var _err$response2,_err$response2$data;setError(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.error)||err.message);}};const deleteInvoice=async id=>{try{await axios.delete(\"\".concat(API_URL,\"/\").concat(id),{headers:{Authorization:localStorage.getItem(\"token\")}});fetchInvoices();}catch(err){var _err$response3,_err$response3$data;setError(((_err$response3=err.response)===null||_err$response3===void 0?void 0:(_err$response3$data=_err$response3.data)===null||_err$response3$data===void 0?void 0:_err$response3$data.error)||err.message);}};const markPaid=async id=>{try{await axios.patch(\"\".concat(API_URL,\"/\").concat(id,\"/paid\"),{},{headers:{Authorization:localStorage.getItem(\"token\")}});fetchInvoices();}catch(err){var _err$response4,_err$response4$data;setError(((_err$response4=err.response)===null||_err$response4===void 0?void 0:(_err$response4$data=_err$response4.data)===null||_err$response4$data===void 0?void 0:_err$response4$data.error)||err.message);}};const exportPDF=async invoice=>{try{const client=clients.find(c=>c._id===invoice.client);generateInvoicePDF(invoice,client);}catch(err){setError(\"Failed to generate PDF: \"+err.message);}};return/*#__PURE__*/_jsxs(\"section\",{className:\"bg-white rounded shadow p-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold mb-2\",children:\"Invoices\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500 mb-2\",children:error}),/*#__PURE__*/_jsx(InvoiceForm,{clients:clients,onSave:addInvoice}),/*#__PURE__*/_jsx(InvoiceList,{invoices:invoices,clients:clients,onDelete:deleteInvoice,onMarkPaid:markPaid,onExportPDF:exportPDF})]});};export default Invoices;","map":{"version":3,"names":["React","useEffect","useState","axios","InvoiceForm","InvoiceList","generateInvoicePDF","jsx","_jsx","jsxs","_jsxs","API_URL","process","env","REACT_APP_API_URL","CLIENTS_URL","Invoices","invoices","setInvoices","clients","setClients","error","setError","fetchInvoices","res","get","headers","Authorization","localStorage","getItem","data","err","_err$response","_err$response$data","response","message","fetchClients","_unused","addInvoice","invoice","post","_err$response2","_err$response2$data","deleteInvoice","id","delete","concat","_err$response3","_err$response3$data","markPaid","patch","_err$response4","_err$response4$data","exportPDF","client","find","c","_id","className","children","onSave","onDelete","onMarkPaid","onExportPDF"],"sources":["C:/Users/raman/OneDrive/Desktop/project/client/src/components/Invoices.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport InvoiceForm from \"./InvoiceForm\";\nimport InvoiceList from \"./InvoiceList\";\nimport { generateInvoicePDF } from \"../utils/pdfExport\";\n\nconst API_URL = process.env.REACT_APP_API_URL + \"/api/invoices\";\nconst CLIENTS_URL = process.env.REACT_APP_API_URL + \"/api/clients\";\n\nconst Invoices = () => {\n  const [invoices, setInvoices] = useState([]);\n  const [clients, setClients] = useState([]);\n  const [error, setError] = useState(\"\");\n\n  const fetchInvoices = async () => {\n    try {\n      const res = await axios.get(API_URL, { headers: { Authorization: localStorage.getItem(\"token\") } });\n      setInvoices(res.data);\n      setError(\"\");\n    } catch (err) {\n      setError(err.response?.data?.error || err.message);\n    }\n  };\n\n  const fetchClients = async () => {\n    try {\n      const res = await axios.get(CLIENTS_URL, { headers: { Authorization: localStorage.getItem(\"token\") } });\n      setClients(res.data);\n    } catch {}\n  };\n\n  useEffect(() => {\n    fetchInvoices();\n    fetchClients();\n  }, []);\n\n  const addInvoice = async (invoice) => {\n    try {\n      await axios.post(API_URL, invoice, { headers: { Authorization: localStorage.getItem(\"token\") } });\n      fetchInvoices();\n      setError(\"\");\n    } catch (err) {\n      setError(err.response?.data?.error || err.message);\n    }\n  };\n\n  const deleteInvoice = async (id) => {\n    try {\n      await axios.delete(`${API_URL}/${id}`, { headers: { Authorization: localStorage.getItem(\"token\") } });\n      fetchInvoices();\n    } catch (err) {\n      setError(err.response?.data?.error || err.message);\n    }\n  };\n\n  const markPaid = async (id) => {\n    try {\n      await axios.patch(`${API_URL}/${id}/paid`, {}, { headers: { Authorization: localStorage.getItem(\"token\") } });\n      fetchInvoices();\n    } catch (err) {\n      setError(err.response?.data?.error || err.message);\n    }\n  };\n\n  const exportPDF = async (invoice) => {\n    try {\n      const client = clients.find(c => c._id === invoice.client);\n      generateInvoicePDF(invoice, client);\n    } catch (err) {\n      setError(\"Failed to generate PDF: \" + err.message);\n    }\n  };\n\n  return (\n    <section className=\"bg-white rounded shadow p-4\">\n      <h2 className=\"text-xl font-semibold mb-2\">Invoices</h2>\n      {error && <div className=\"text-red-500 mb-2\">{error}</div>}\n      <InvoiceForm clients={clients} onSave={addInvoice} />\n      <InvoiceList invoices={invoices} clients={clients} onDelete={deleteInvoice} onMarkPaid={markPaid} onExportPDF={exportPDF} />\n    </section>\n  );\n};\n\nexport default Invoices;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}